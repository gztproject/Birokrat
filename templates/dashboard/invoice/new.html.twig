{% extends 'dashboard/layout.html.twig' %}

{% block body_id 'invoice_new' %}

{% block stylesheets %}
    {{ parent() }}
    {{ encore_entry_link_tags('css/invoice') }}
{% endblock %}

{% block main %}
    <h1>{{ 'title.invoice_new'|trans }}</h1>

    {{ form_start(form) }} 
    <div class="jumbotron" id="InvoiceFormContainer"> 
        <div class="row">
            <div class="col-sm-6">
                <div class="form-group">                    
                        {{ form_label(form.issuer, null, {'label_attr': {'class': 'col-form-label-lg'}} ) }}
                        <div class='input-group'>
                        {{ form_widget(form.issuer, {'attr': {'class': 'form-control'}}) }}                
                    </div>
                </div>            
            </div>
        </div> 
        <div class="row">
            <div class="col-sm-6">
                <div class="form-group">
                    {{ form_label(form.recepient, null, {'label_attr': {'class': 'col-form-label-lg'}} ) }}
                    <div class='input-group'>
                        {{ form_widget(form.recepient, {'attr': {'class': 'form-control'}}) }}                
                    </div>
                </div>            
            </div>  
            <div class="col-sm-6">
                <div class="form-group">                    
                        {{ form_label(form.number, null, {'label_attr': {'class': 'col-form-label-lg'}} ) }}
                        <div class='input-group'>
                        {{ form_widget(form.number, {'attr': {'class': 'form-control'}}) }}                
                    </div>
                </div>
            </div>                             
        </div>
        <div class="row">
            <div class="col-sm-3">
                <div class="form-group">                   
                        {{ form_label(form.dateOfIssue, null, {'label_attr': {'class': 'col-form-label-lg'}} ) }}
                         <div id="dateOfIssue" class='input-group'>
                        {{ form_widget(form.dateOfIssue, {'attr': {'class': 'form-control'}}) }}
                        <div class="input-group-append">
                            <span class="input-group-text"><i class="fa fa-calendar" aria-hidden="true"></i></span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-3">
            </div>
            <div class="col-sm-3">
                <div class="form-group">
                        <label class='col-form-label-lg' for='invoice_dueInDays'>{{ 'label.dueInDays' | trans }}</label>
                        <div id="dueInDays"  class='input-group'>
                        <input id='invoice_dueInDays' class='form-control' type='number'>
                        <div class="input-group-append">
                            <span class="input-group-text">{{ 'label.days' | trans }}</span>
                        </div>                       
                    </div>
                </div>
            </div>
            <div class="col-sm-3">
                <div class="form-group">                    
                        {{ form_label(form.dueDate, null, {'label_attr': {'class': 'col-form-label-lg'}} ) }}
                        <div id="dueDate" class='input-group'>
                        {{ form_widget(form.dueDate, {'attr': {'class': 'form-control'}}) }}
                        <div class="input-group-append">
                            <span class="input-group-text"><i class="fa fa-calendar" aria-hidden="true"></i></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-6">
            </div>
            <div class="col-sm-3">
                 <div class="form-group">                    
                        {{ form_label(form.dateServiceRenderedFrom, null, {'label_attr': {'class': 'col-form-label-lg'}} ) }}
                        <div id='dateServiceRenderedFrom' class='input-group'>
                        {{ form_widget(form.dateServiceRenderedFrom, {'attr': {'class': 'form-control'}}) }} 
                        <div class="input-group-append">
                            <span class="input-group-text"><i class="fa fa-calendar" aria-hidden="true"></i></span>
                        </div>                   
                    </div>
                </div>
            </div>
            <div class="col-sm-3">
                 <div class="form-group">                    
                        {{ form_label(form.dateServiceRenderedTo, null, {'label_attr': {'class': 'col-form-label-lg'}} ) }}
                        <div id='dateServiceRenderedTo' class='input-group'>
                        {{ form_widget(form.dateServiceRenderedTo, {'attr': {'class': 'form-control'}}) }}  
                        <div class="input-group-append">
                            <span class="input-group-text"><i class="fa fa-calendar" aria-hidden="true"></i></span>
                        </div>                      
                    </div>
                </div>
            </div>
        </div> 
        
        <div class="bs-component table-responsive-sm">            
            <table id="invoice-items-table" class="table table-sm w-auto">                
                <thead>
                    <tr>
                        <th class="th-sm">{{ 'label.code'|trans }}</th>
                        <th class="th-lg">{{ 'label.name'|trans }}</th>
                        <th>{{ 'label.quantity'|trans }}</th>
                        <th>{{ 'label.unit'|trans }}</th>
                        <th>{{ 'label.price'|trans }}</th>
                        <th>{{ 'label.discount'|trans }}</th>
                        <th>{{ 'label.value'|trans }}</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody id='tableBody' class="invoiceItems" data-prototype="{{ form_widget(form.createInvoiceItemCommands.vars.prototype)|e('html_attr') }}">

                {% for invoiceItem in form.createInvoiceItemCommands %}
                    <tr>
                        <td>{{ form_widget(invoiceItem.code, {'attr': {'class': 'form-control'}})}}</td>
                        <td>{{ form_widget(invoiceItem.name, {'attr': {'class': 'form-control'}})}}</td>
                        <td>{{ form_widget(invoiceItem.quantity, {'attr': {'class': 'form-control'}})}}</td>
                        <td>{{ form_widget(invoiceItem.unit, {'attr': {'class': 'form-control'}})}}</td>
                        <td>{{ form_widget(invoiceItem.price, {'attr': {'class': 'form-control'}})}}</td>
                        <td class='input-group'>{{ form_widget(invoiceItem.discount, {'attr': {'class': 'form-control'}})}}</td>
                        <td>{{ ((invoiceItem.price * invoiceItem.Quantity) * (1-invoiceItem.discount/100))|number_format(2, ',', ' ') }}</td>
                        <td></td>
                        <!-- <td><div class="form-group"><div class='input-group'>{{ form_widget(invoiceItem.price, {'attr': {'class': 'form-control'}})}}                        <div class="input-group-append">
                            <span class="input-group-text">€</span>
                        </div></div></div></td> -->
                    </tr>
                {% endfor %}
                </tbody>
            </table>   
        </div> 
        <div class="row">
        <div class="col-sm-7">                
            </div>
            <div class="col-sm-2">
                <div class="form-group">                    
                        {{ form_label(form.discount, null, {'label_attr': {'class': 'col-form-label-lg'}} ) }}
                        <div id="discount" class='input-group'>
                        {{ form_widget(form.discount, {'attr': {'class': 'form-control'}}) }}   
                        <div class="input-group-append">
                            <span class="input-group-text">%</span>
                        </div>
                    </div>                 
                </div>
            </div>            
            <div class="col-sm-3">
                <div class="form-group">                    
                        <label for="totalPrice" class="col-form-label-lg">{{ 'label.total'|trans }}</label>
                        <div class='input-group'>
                            <input id="totalPrice" class='form-control' type="text" placeholder="0,00" readonly="">  
                        <div class="input-group-append">
                            <span class="input-group-text">€</span>
                        </div>
                    </div>                 
                </div>
            </div>  
        </div>
        </div>
        <div class="form-group">
            <button type="submit" class="btn btn-primary">
                <i class="fa fa-save" aria-hidden="true"></i> {{ 'label.create_invoice'|trans }}
            </button>
            {{ form_widget(form.saveAndCreateNew, {label: 'label.save_and_create_new', attr: {class: 'btn btn-primary'}}) }}
            <a href="{{ path('invoice_index') }}" class="btn btn-link">
                <i class="fa fa-list-alt" aria-hidden="true"></i> {{ 'action.back_to_list'|trans }}
            </a>
       
    </div>
    {{ form_row(form._token) }}
    {{ form_end(form, {'render_rest': false}) }}

{% endblock %}

{% block sidebar %}
    {{ parent() }}

{% endblock %}

{% block javascripts %}
    {{ parent() }}
    {{ encore_entry_script_tags('js/invoice/new') }}
{% endblock %}
